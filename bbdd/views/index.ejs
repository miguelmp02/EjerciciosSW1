<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrador de Videojuegos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container mt-3">
        <h1>Videojuegos</h1>
        <div id="gamesList"></div>
        <button class="btn btn-primary my-3" onclick="fetchGames()">Actualizar Lista</button>

        <!-- Formulario para agregar o actualizar juegos -->
        <h2>Agregar/Actualizar Juego</h2>
        <form id="gameForm">
            <input type="hidden" id="gameId">
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" required>
            </div>
            <div class="mb-3">
                <label for="descripcion" class="form-label">Descripci√≥n</label>
                <textarea class="form-control" id="descripcion" rows="3" required></textarea>
            </div>
            <div class="mb-3">
                <label for="foto" class="form-label">Foto (URL)</label>
                <input type="url" class="form-control" id="foto" required>
            </div>
            <div class="mb-3">
                <label for="video" class="form-label">Video (URL)</label>
                <input type="url" class="form-control" id="video" required>
            </div>
            <button type="submit" class="btn btn-success">Guardar</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // Funciones de JavaScript para interactuar con la API
        document.getElementById('gameForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const gameId = document.getElementById('gameId').value;
            const gameData = {
                nombre: document.getElementById('nombre').value,
                descripcion: document.getElementById('descripcion').value,
                foto: document.getElementById('foto').value,
                video: document.getElementById('video').value
            };
            if (gameId) {
                axios.put('/games/' + gameId, gameData)
                    .then(() => {
                        alert('Juego actualizado');
                        fetchGames();
                    }).catch(error => alert('Error al actualizar el juego'));
            } else {
                axios.post('/games', gameData)
                    .then(() => {
                        alert('Juego agregado');
                        fetchGames();
                    }).catch(error => alert('Error al agregar el juego'));
            }
        });

        function fetchGames() {
            axios.get('/games')
                .then(response => {
                    const gamesList = document.getElementById('gamesList');
                    gamesList.innerHTML = '';
                    response.data.forEach(game => {
                        const gameElement = document.createElement('div');
                        gameElement.innerHTML = `
                            <h3>${game.nombre}</h3>
                            <p>${game.descripcion}</p>
                            <p><img src="${game.foto}" style="width: 200px;" alt="Foto del juego"></p>
                            <p><a href="${game.video}" target="_blank">Ver Video</a></p>
                            <button onclick="editGame(${game.id})" class="btn btn-warning">Editar</button>
                            <button onclick="deleteGame(${game.id})" class="btn btn-danger">Eliminar</button>
                        `;
                        gamesList.appendChild(gameElement);
                    });
                }).catch(error => alert('Error al obtener los juegos'));
        }

        function editGame(id) {
            axios.get('/games/' + id)
                .then(response => {
                    const game = response.data;
                    document.getElementById('gameId').value = game.id;
                    document.getElementById('nombre').value = game.nombre;
                    document.getElementById('descripcion').value = game.descripcion;
                    document.getElementById('foto').value = game.foto;
                    document.getElementById('video').value = game.video;
                }).catch(error => alert('Error al editar el juego'));
        }

        function deleteGame(id) {
            axios.delete('/games/' + id)
                .then(() => {
                    alert('Juego eliminado');
                    fetchGames();
                }).catch(error => alert('Error al eliminar el juego'));
        }

        // Inicialmente cargar juegos
        fetchGames();
    </script>
</body>
</html>
